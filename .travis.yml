language: c
cache: ccache
matrix:
  - compiler: gcc
    env: CC=gcc
         CXX=g++
  - compiler: clang
    env: CC=clang
         CXX=clang++
env:
  MAKEFLAGS="-j2"
install:
  - export PREFIX="/usr"
  - sudo apt-get install libgmp-dev libmpfr-dev valgrind
  # install FLINT
  - wget http://flintlib.org/flint-2.5.2.tar.gz
  - tar xf flint-2.5.2.tar.gz
  - cd flint-2.5.2
  - ./configure && make && sudo make install
  - cd ..
  # install Arb
  - wget https://github.com/fredrik-johansson/arb/archive/2.16.0.tar.gz
  - tar xf 2.16.0.tar.gz
  - cd arb-2.16.0
  - ./configure && make && sudo make install
  - cd ..
  # install E-ANTIC
  - ./bootstrap.sh
  - ./configure --enable-valgrind
  - cat config.log
  - make
  - ldd .libs/libeantic.so

script:
  - V=1 make check
  - V=1 make check-valgrind
  - V=1 make distcheck
